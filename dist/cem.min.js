!function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0].call(h.exports,function(b){var e=a[c][1][b];return d(e?e:b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a,b,c){c.Manager=a("./manager"),c.Entity=a("./entity"),"undefined"!=typeof window&&(window.CEM=c)},{"./manager":2,"./entity":3}],3:[function(a,b){var c=a("./utils"),d={requires:!0,bootstrap:!0,destroy:!0},e=b.exports=function(a){this.id=null,this.destroyed=!1,this.__manager=a,this.__components=[],this.__component_hash={},this.__properties={}};e.prototype.bootstrap=function(){var a=arguments;this.__components.forEach(function(b){b.bootstrap&&b.bootstrap.apply(this,a)},this)},e.prototype.destroy=function(){this.trigger&&this.trigger("destroy"),this.destroyed=!0},e.prototype.__extend=function(a){var b,e,f=this;if("string"==typeof a){var b=this.__manager.components[a];if(!b)throw"Unknown component: "+a;a=b}if(a.__name){if(this.__component_hash[a.__name])return;this.__component_hash[a.__name]=a}this.__components.push(a),a.requires&&a.requires.split(" ").forEach(function(a){a&&this.__extend(a)},this),Object.keys(a).forEach(function(b){"__"==b.slice(0,2)||d[b]||(e=a[b],"function"==typeof e?(a.__name||console.log("Adding functions via anonymous components is not recommended! These properties will not be restored on deserialization."),f[b]=e):("object"==typeof e&&(e=c.deep_copy(e)),void 0===f.__properties[b]&&Object.defineProperty(f,b,{set:function(a){f.__properties[b]=a,f.trigger&&f.trigger("set_"+b,[a])},get:function(){return f.__properties[b]}}),f.__properties[b]=e))})},e.prototype.is=function(a){return void 0!=this.__component_hash[a]}},{"./utils":4}],2:[function(a,b){var c=a("./entity"),d=a("./utils"),e=a("./builtins"),f=b.exports=function(){this.components={},this.entities={},this.register_builtins()};f.prototype.register_builtins=function(){this.c("evented",e.evented),this.c("object",e.object),this.c("collection",e.collection)},f.prototype.base_component="object",f.prototype.clone=function(){var a=new f;return a.components=this.components,a},f.prototype.component=f.prototype.c=function(a,b){b=b||{},b.__name=a,this.components[a]&&console.log("WARNING! Component already registered: "+a),this.components[a]=b},f.prototype.get=function(a){return this.entities[a]},f.prototype.entity=f.prototype.e=function(){if(!arguments.length)throw"No components specified.";var a,b=new c(this);this.base_component&&b.__extend(this.base_component);for(var a=0;a<arguments.length;a++)b.__extend(arguments[a]);if(b.id||(b.id=d.generate_id()),this.entities[b.id])throw"Entity with this id already exists";return b.bootstrap(),this.entities[b.id]=b,b.on&&b.on("destroy",function(){delete this.entities[b.id]},this),b}},{"./entity":3,"./utils":4,"./builtins":5}],4:[function(a,b,c){c.deep_copy=function(a){return JSON.parse(JSON.stringify(a))},c.generate_id=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}},{}],5:[function(a,b,c){c.collection=a("./collection"),c.evented=a("./evented"),c.object=a("./object")},{"./collection":6,"./evented":7,"./object":8}],6:[function(a,b){b.exports={_objects:[],_objects_by_id:{},length:0,add:function(a){this._objects.push(a),this._objects_by_id[a.id]=a,this.observe("object",a),this.length++,this.trigger("add",[a]),a.on("destroy",function(){this.remove(a)},this)},get:function(a){return this._objects_by_id[a]},remove:function(a){this.unobserve(a),this.length--,delete this._objects_by_id[a.id],this._objects=this._objects.filter(function(b){return b.id!=a.id}),a.off("destroy",null,this),this.trigger("remove",[a])},each:function(a,b){this._objects.forEach(a,b)}}},{}],7:[function(a,b){function c(a){return"string"==typeof a&&(a=a.split(" ")),a}b.exports={_callbacks:{},_observed_by:[],_suppress_events:!1,bootstrap:function(){for(var a in this)"event_"==a.substring(0,6)&&!function(a,b,c){c[a]=function(){c.trigger(a,arguments)},c.on(a,b,c)}(a.substring(6),this[a],this)},_on:function(a,b,c,d){if(this._callbacks[a]=this._callbacks[a]||[],this._callbacks[a].push({callback:b,context:c,once:d}),c&&c.on){var e=this;c.on("destroy",function(){e.off(a,b,c)})}},on:function(a,b,d,e){c(a).forEach(function(a){this._on(a,b,d,e)},this)},_off:function(a,b,c){this._callbacks[a]&&(this._callbacks[a]=this._callbacks[a].filter(function(a){return b&&b.toString()!=a.callback.toString()||c&&c!==a.context}))},off:function(a,b,d){c(a).forEach(function(a){this._off(a,b,d)},this)},once:function(a,b,c){this.on(a,b,c,!0)},observe:function(a,b){if(!b._observed_by)throw new Error("trying to observe unobservable",b);b._observed_by.push({prefix:a,observer:this})},unobserve:function(a){a._observed_by&&(a._observed_by=a._observed_by.filter(function(a){return a.observer!==this},this))},_trigger:function(a,b){this._callbacks[a]&&(this._callbacks[a]=this._callbacks[a].filter(function(a){return this.destroyed||a.callback.apply(a.context,b),!a.once},this))},trigger:function(a,b){if(b=(b||[]).slice(0),!this._suppress_events){for(var c in this)0!=c.indexOf("on_"+a)||this.destroyed||this[c].apply(this,b);b?b.splice(0,0,this):b=[this],this._trigger(a,b),this._observed_by.forEach(function(c){c.observer.trigger(c.prefix+":"+a,b)}),b.splice(0,0,a),this._trigger("*",b)}}}},{}],8:[function(a,b){b.exports={requires:"evented"}},{}]},{},[1]);